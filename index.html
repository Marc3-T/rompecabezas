<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rompecabeor</title>
    <link href="https://fonts.googleapis.com/css2?family=Patrick+Hand&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Patrick Hand', cursive;
            margin: 0;
            padding: 0;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background: linear-gradient(120deg, #ff758c, #ff7eb3, #fad0c4);
            touch-action: none;
        }

        #puzzle-container {
            position: relative;
            width: 300px;
            height: 450px;
            border: 2px solid #ff6f61;
            background-color: #fff0f6;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }

        #template {
            position: absolute;
            width: 100%;
            height: 100%;
            background-image: url('t.jpg');
            background-size: 300px 450px;
            opacity: 0.3;
            pointer-events: none;
        }

        .puzzle-piece {
            position: absolute;
            cursor: grab;
            user-select: none;
            border: 2px solid #ff6f61;
            box-sizing: border-box;
            transition: transform 0.2s ease;
            background-color: #ffe5e0;
        }

        .puzzle-piece.correct {
            cursor: default;
            border-color: #ff477e;
            pointer-events: none;
        }

        #congrats-message {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #fff0f6;
            color: #ff6f61;
            padding: 20px;
            border-radius: 15px;
            font-size: 24px;
            text-align: center;
            z-index: 1000;
            border: 2px solid #ff6f61;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }
    </style>
</head>
<body>
    <div id="puzzle-container">
        <div id="template"></div>
    </div>
    <div id="congrats-message">
        <div>Te amo ❤️</div>
        <img src="t.jpg" alt="Imagen completada">
    </div>

    <script>
        const rows = 3, cols = 3;
        const pieceWidth = 100, pieceHeight = 150;
        const puzzleContainer = document.getElementById('puzzle-container');
        const congratsMessage = document.getElementById('congrats-message');

        function createPuzzle() {
            const pieces = [];
            for (let i = 0; i < rows; i++) {
                for (let j = 0; j < cols; j++) {
                    const piece = document.createElement('div');
                    piece.classList.add('puzzle-piece');
                    piece.style.width = `${pieceWidth}px`;
                    piece.style.height = `${pieceHeight}px`;
                    piece.style.backgroundImage = `url('t.jpg')`;
                    piece.style.backgroundSize = `300px 450px`;
                    piece.style.backgroundPosition = `-${j * pieceWidth}px -${i * pieceHeight}px`;
                    piece.correctX = j * pieceWidth;
                    piece.correctY = i * pieceHeight;
                    makeDraggable(piece);
                    pieces.push(piece);
                }
            }
            distributePieces(pieces);
        }

        function distributePieces(pieces) {
            pieces.forEach(piece => {
                piece.style.left = `${Math.random() * (window.innerWidth - pieceWidth)}px`;
                piece.style.top = `${Math.random() * (window.innerHeight - pieceHeight)}px`;
                document.body.appendChild(piece);
            });
        }

        function makeDraggable(element) {
            let isDragging = false, offsetX, offsetY;
            element.addEventListener('mousedown', (e) => {
                if (!element.classList.contains('correct')) {
                    isDragging = true;
                    offsetX = e.clientX - element.getBoundingClientRect().left;
                    offsetY = e.clientY - element.getBoundingClientRect().top;
                }
            });
            document.addEventListener('mousemove', (e) => {
                if (isDragging) {
                    element.style.left = `${e.clientX - offsetX}px`;
                    element.style.top = `${e.clientY - offsetY}px`;
                }
            });
            document.addEventListener('mouseup', () => {
                if (isDragging) {
                    isDragging = false;
                    checkPlacement(element);
                }
            });
        }

        function checkPlacement(element) {
            const rect = element.getBoundingClientRect();
            const puzzleRect = puzzleContainer.getBoundingClientRect();
            const pieceX = rect.left - puzzleRect.left;
            const pieceY = rect.top - puzzleRect.top;

            if (Math.abs(pieceX - element.correctX) < 50 && Math.abs(pieceY - element.correctY) < 50) {
                element.style.left = `${puzzleRect.left + element.correctX}px`;
                element.style.top = `${puzzleRect.top + element.correctY}px`;
                element.classList.add('correct');
                checkCompletion();
            }
        }

        function checkCompletion() {
            const pieces = document.querySelectorAll('.puzzle-piece');
            if (Array.from(pieces).every(piece => piece.classList.contains('correct'))) {
                congratsMessage.style.display = 'block';
            }
        }

        createPuzzle();
    </script>
</body>
</html>
